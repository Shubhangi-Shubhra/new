MERGE INTO PKML_API_REQUEST_TRACKING tgt
USING (
  SELECT
    'TRANS-1'          AS TRANSACTION_ID,
    'AIT-70858-PACKDASH' AS CLIENT_ID,
    'EET_100002'       AS API_ID,
    'TEST-1'           AS ENTITY_ID,
    TO_DATE('20-12-2025 02:57:09','DD-MM-YYYY HH24:MI:SS') AS START_TIME,
    TO_DATE('20-12-2025 02:57:39','DD-MM-YYYY HH24:MI:SS') AS END_TIME,
    400                AS HTTPS_STATUS_CODE,
    'ERROR-1'          AS ERROR_CODE
  FROM dual
) src
ON (tgt.TRANSACTION_ID = src.TRANSACTION_ID)
WHEN NOT MATCHED THEN
  INSERT (
    TRANSACTION_ID, CLIENT_ID, API_ID, ENTITY_ID,
    START_TIME, END_TIME, HTTPS_STATUS_CODE, ERROR_CODE
  )
  VALUES (
    src.TRANSACTION_ID, src.CLIENT_ID, src.API_ID, src.ENTITY_ID,
    src.START_TIME, src.END_TIME, src.HTTPS_STATUS_CODE, src.ERROR_CODE
  )
WHEN MATCHED THEN
  UPDATE SET
    tgt.ENTITY_ID         = COALESCE(src.ENTITY_ID,        tgt.ENTITY_ID),
    tgt.END_TIME          = COALESCE(src.END_TIME,         tgt.END_TIME),
    tgt.HTTPS_STATUS_CODE = COALESCE(src.HTTPS_STATUS_CODE,tgt.HTTPS_STATUS_CODE),
    tgt.ERROR_CODE        = COALESCE(src.ERROR_CODE,       tgt.ERROR_CODE);
